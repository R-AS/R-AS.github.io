{"componentChunkName":"component---src-templates-blog-post-jsx","path":"/blogs/interview-计算机基础/web_2/","result":{"data":{"markdownRemark":{"fileAbsolutePath":"/Users/zhengjinyang/Documents/study/R-AS.github.io/src/pages/blogs/interview-计算机基础/web_2.md","html":"<div class=\"toc\">\n<ul>\n<li><a href=\"#%E4%B8%89%E6%AC%A1%E6%8F%A1%E6%89%8B\">三次握手</a></li>\n<li><a href=\"#%E5%9B%9B%E6%AC%A1%E6%8C%A5%E6%89%8B\">四次挥手</a></li>\n</ul>\n</div>\n<hr>\n<h4 id=\"三次握手\">三次握手</h4>\n<p>建立一个 TCP 连接，客户端与服务器交互需要 3 个数据包。握手的主要作用就是为了确认双方的接收和发送能力是否正常，初始序列号、交换窗口大小以及 MSS 等信息。</p>\n<p><img src=\"/blogs/interview-%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/web_2_pic_1.png#pic_center\" alt=\"pic_1\"></p>\n<ol>\n<li>第一次握手，客户端发送 <font color=#f0764c>SYN</font> 报文，并进入 <font color=#f0764c>SYN_SENT</font> 状态，等待服务器的确认。</li>\n<li>第二次握手，服务器收到 <font color=#f0764c>SYN</font> 报文，需要给客户端发送 <font color=#f0764c>ACK</font> 确认报文，同时服务器也要向客户端发送一个 <font color=#f0764c>SYN</font> 报文，所以也就是向客户端发送 <font color=#f0764c>SYN + ACK</font> 报文，此时服务器进入 <font color=#f0764c>SYN_RCVD</font> 状态。</li>\n<li>第三次握手，客户端收到 <font color=#f0764c>SYN + ACK</font> 报文，向服务器发送确认包，客户端进入 <font color=#f0764c>ESTABLISHED</font> 状态。待服务器收到客户端发送的 <font color=#f0764c>ACK</font> 包也会进入 <font color=#f0764c>ESTABLISHED</font> 状态，完成三次握手。</li>\n</ol>\n<hr>\n<h4 id=\"四次挥手\">四次挥手</h4>\n<p><img src=\"/blogs/interview-%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/web_2_pic_2.png#pic_center\" alt=\"pic_1\"></p>\n<ol>\n<li>第一次挥手，客户端发起 <font color=#f0764c>FIN</font>包（FIN = 1），客户端进入 <font color=#f0764c>FIN<em>WAIT</em>1</font> 状态。</li>\n<li>第二次挥手，服务器收到 <font color=#f0764c>FIN</font> 包，发出确认包 <font color=#f0764c>ACK</font>（ack = u + 1），并带上自己的序号 seq=v，服务器进入 <font color=#f0764c>CLOSE<em>WAIT</font> 状态。这个时候客户端已经没有数据要发送了，不过服务器端有数据发送端话，客户端依然需要接收。客户端接收到服务器端发送端 <font color=#f0764c>ACK</font> 后，进入 <font color=#f0764c>FIN</em>WAIT_2</font> 状态。</li>\n<li>第三次挥手，服务器端数据发送完毕后，向客户端发送 <font color=#f0764c>FIN</font> 包（seq=w, ack=u+1），半连接状态下服务器可能又发送了一些数据，假设发送 seq 为 w。服务器此时进入了 <font color=#f0764c>LAST_ACK</font> 状态。</li>\n<li>第四次挥手，客户端收到服务器的 <font color=#f0764c>FIN</font> 包后，发出确认包（ACK=1，ack=w+1）,此时客户端就进入了 <font color=#f0764c>TIME_WAIT</font> 状态。注意此时 TCP 连接还没有释放，必须经过 <font color=#f0764c>2*MSL</font> 后，才进入 <font color=#f0764c>CLOSED</font> 状态。而服务器端收到客户端的确认包 <font color=#f0764c>ACK</font> 后就进入了 <font color=#f0764c>CLOSED</font> 状态，可以看出服务器端结束 TCP 连接的时间要比客户端早一些。</li>\n</ol>\n<style class=\"grvsc-styles\">\n  .grvsc-container {\n    overflow: auto;\n    -webkit-overflow-scrolling: touch;\n    padding-top: 1rem;\n    padding-top: var(--grvsc-padding-top, var(--grvsc-padding-v, 1rem));\n    padding-bottom: 1rem;\n    padding-bottom: var(--grvsc-padding-bottom, var(--grvsc-padding-v, 1rem));\n    border-radius: 8px;\n    border-radius: var(--grvsc-border-radius, 8px);\n    font-feature-settings: normal;\n  }\n  \n  .grvsc-code {\n    display: inline-block;\n    min-width: 100%;\n  }\n  \n  .grvsc-line {\n    display: inline-block;\n    box-sizing: border-box;\n    width: 100%;\n    padding-left: 1.5rem;\n    padding-left: var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem));\n    padding-right: 1.5rem;\n    padding-right: var(--grvsc-padding-right, var(--grvsc-padding-h, 1.5rem));\n  }\n  \n  .grvsc-line-highlighted {\n    background-color: var(--grvsc-line-highlighted-background-color, transparent);\n    box-shadow: inset var(--grvsc-line-highlighted-border-width, 4px) 0 0 0 var(--grvsc-line-highlighted-border-color, transparent);\n  }\n  \n</style>","frontmatter":{"title":"TCP 三次握手、四次挥手","date":"2022-10-12","type":"interview-计算机基础"},"excerpt":"三次握手 四次挥手三次握手 建立一个 TCP 连接，客户端与服务器交互需要 3 个数据包。握手的主要作用就是为了确认双方的接收和发送能力是否正常，初始序列号、交换窗口大小以及 MSS 等信息。 pic_1 第一次握手，客户端发送 SYN 报文，并进入 SYN_SENT…","fields":{"readingTime":{"text":"3 min read"}}},"allDirectory":{"totalCount":14,"edges":[{"node":{"base":"css"}},{"node":{"base":"interview-css"}},{"node":{"base":"frontend"}},{"node":{"base":"interview-javascript"}},{"node":{"base":"interview-浏览器"}},{"node":{"base":"interview-计算机基础"}},{"node":{"base":"javascript"}},{"node":{"base":"nodejs"}},{"node":{"base":"react"}},{"node":{"base":"redux-tool-kit"}},{"node":{"base":"vue"}},{"node":{"base":"typescript"}},{"node":{"base":"小程序"}},{"node":{"base":"科普"}}]}},"pageContext":{"slug":"/interview-计算机基础/web_2/"}},"staticQueryHashes":["1487620982","3141419394","3649515864"]}